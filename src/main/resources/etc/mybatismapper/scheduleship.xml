<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="scheduleship">

	<cache />

	<insert id="createScheduleShip" parameterType="org.uario.seaworkengine.model.ScheduleShip">
		INSERT INTO
		scheduleship
		(idship, volume, note, arrivaldate)
		VALUES
		(#{idship},
		#{volume}, #{note}, #{arrivaldate});
	</insert>

	<delete id="deleteScheduleShip" parameterType="Integer">
		delete from
		scheduleship
		where
		id = #{id_scheduleShip}
	</delete>

	<select id="loadScheduleShip" parameterType="Integer"
		resultType="org.uario.seaworkengine.model.ScheduleShip">
		SELECT s.id, s.idship, s.volume, s.note, s.arrivaldate,
		sh.name
		FROM
		scheduleship s, ship sh
		where s.idship = sh.id and
		s.id =
		#{id_scheduleShip};
	</select>

	<select id="loadAllScheduleShip" resultType="org.uario.seaworkengine.model.ScheduleShip">
		SELECT s.id,
		s.idship, s.volume, s.note, s.arrivaldate,
		sh.name
		FROM
		scheduleship s,
		ship sh
		where s.idship = sh.id
	</select>

	<select id="selectAllScheduleShipFulltextSearchLike"
		parameterType="String" resultType="org.uario.seaworkengine.model.ScheduleShip">
		SELECT s.id, s.idship, s.volume, s.note, s.arrivaldate,
		sh.name
		FROM
		scheduleship s, ship sh
		<if test="my_full_text_search != null">
		WHERE (sh.name like CONCAT('%',#{my_full_text_search}, '%') and s.idship = sh.id)			
		</if>
		order by s.id;
	</select>


	<update id="updateScheduleShip" parameterType="org.uario.seaworkengine.model.ScheduleShip">
		UPDATE
		scheduleship
		SET
		idship = #{idship},
		volume = #{volume},
		note = #{note},
		arrivaldate =
		#{arrivaldate}

		WHERE id = #{id};
	</update>



	<insert id="createDetailScheduleShip" parameterType="org.uario.seaworkengine.model.DetailScheduleShip">
		INSERT INTO
		detailscheduleship
		(idscheduleship, shift, operation, iduser,
		handswork)
		VALUES
		(#{idscheduleship}, #{shift}, #{operation}, #{iduser},
		#{handswork});
	</insert>

	<delete id="deleteDetailScheduleShip" parameterType="Integer">
		delete from
		detailscheduleship
		where
		id = #{id_detailScheduleShip}
	</delete>

	<select id="loadDetailScheduleShip" parameterType="Integer"
		resultType="org.uario.seaworkengine.model.DetailScheduleShip">
		SELECT d.id, d.idscheduleship, d.shift, d.operation, d.iduser,
		d.handswork, s.firstname, s.lastname
		FROM
		detailscheduleship d, user u where
		d.id = #{id_detailScheduleShip} and d.iduser = u.id;
	</select>

	<select id="loadDetailScheduleShipByIdSchedule" parameterType="Integer" resultType="org.uario.seaworkengine.model.DetailScheduleShip">
		SELECT id, idscheduleship, shift, operation, iduser, handswork
		FROM
		detailscheduleship where
		idscheduleship = #{id_scheduleShip};
	</select>

	<select id="loadScheduleShipByIdShipAndArrivalDate" parameterType="map" resultType="org.uario.seaworkengine.model.ScheduleShip" >
		SELECT id, idship, volume, note, arrivaldate
		FROM
		scheduleship where
		idship = #{idship} and
		arrivaldate = #{arrivaldate};
	</select>

	<update id="updateDetailScheduleShip" parameterType="org.uario.seaworkengine.model.DetailScheduleShip">
		UPDATE
		detailscheduleship SET
		idscheduleship = #{idscheduleship},
		shift
		=
		#{shift},
		operation = #{operation},
		iduser = #{iduser},
		handswork =
		#{handswork}
		WHERE id = #{id}
	</update>



</mapper>